<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Unsplash Image Download</title>
    <style>
        /* basic unsplash-style layout */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px;
        }
        .search-bar {
            width: 100%;
            padding: 12px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        .image-grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 20px; 
        }
        .image-card { 
            position: relative; 
            border-radius: 4px; 
            overflow: hidden;
            cursor: pointer;
        }
        img { 
            width: 100%; 
            height: 300px; 
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        img:hover {
            transform: scale(1.05);
        }
        .download-btn { 
            position: absolute; 
            bottom: 10px; 
            right: 10px; 
            background: #fff; 
            padding: 8px 16px; 
            border-radius: 4px; 
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* dark patterns styling */
        .premium-badge { 
            position: absolute; 
            top: 10px; 
            left: 10px; 
            background: #4CAF50; 
            color: white; 
            padding: 4px 8px; 
            border-radius: 4px;
            font-size: 12px;
        }
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
            z-index: 1000;
            max-width: 90%;
        }
        .modal-option { 
            margin: 10px 0; 
            padding: 12px 20px;
            cursor: pointer;
            border-radius: 4px;
        }
        .premium-modal {
            text-align: center;
        }
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 999;
        }
        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            margin: 2% auto;
        }
        .attribution {
            color: white;
            text-align: center;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Unsplash Image Download</h1>
    <input type="search" class="search-bar" placeholder="Search images..." id="searchInput">
    <div class="image-grid" id="imageContainer"></div>

    <!-- dark patterns modals -->
    <div class="modal" id="downloadModal">
        <h3>Download Options</h3>
        <div class="modal-option" style="background: #4CAF50; color: white;" 
             onclick="handlePremiumDownload()">
            ðŸ”¥ HD Download (Recommended)
        </div>
        <div class="modal-option" style="border: 1px solid #ddd;" 
             onclick="handleFreeDownload()">
            Standard Quality (Free)
        </div>
        <p style="font-size: 0.9em; color: #666; margin-top: 20px;">
            <input type="checkbox" id="newsletter" checked hidden>
            <label for="newsletter">Get photography tips and offers (Recommended)</label>
        </p>
    </div>

    <div class="modal premium-modal" id="premiumModal">
        <h2>ðŸ”’ Premium HD Access</h2>
        <p>Unlock HD downloads for just $9.99/month</p>
        <input type="email" placeholder="Enter your email" style="width: 100%; padding: 10px; margin: 10px 0;">
        <button class="modal-option" style="background: #4CAF50; color: white; width: 100%;">
            Subscribe Now
        </button>
        <p style="font-size: 0.8em; color: #666; margin-top: 15px;">
            By subscribing, you agree to our <a href="#">terms of service</a>
        </p>
    </div>

    <!-- lightbox for image preview -->
    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <div class="lightbox-content">
            <img id="expandedImg" src="" alt="Expanded view">
            <div class="attribution" id="imageAttribution"></div>
        </div>
    </div>

    <script>
        const API_KEY = 'tBu1oUa1VCm3RTCRgzqE3Zu-msPE1rQQiGMbXyXXNT4';
        let currentPhotoData = null;

        // load images from unsplash
        async function loadImages(query = '') {
            const endpoint = query ? 
                `https://api.unsplash.com/search/photos?query=${query}&per_page=9` :
                `https://api.unsplash.com/photos/random?count=9`;
            
            try {
                const response = await fetch(`${endpoint}&client_id=${API_KEY}`);
                const data = query ? (await response.json()).results : await response.json();
                
                document.getElementById('imageContainer').innerHTML = '';
                data.forEach(img => {
                    const card = document.createElement('div');
                    card.className = 'image-card';
                    card.innerHTML = `
                        <img src="${img.urls.regular}" alt="${img.alt_description}" 
                             onclick="showLightbox('${img.urls.regular}', ${JSON.stringify(img).replace(/"/g, '&quot;')})">
                        <div class="premium-badge">HD Available</div>
                        <button class="download-btn" onclick="showDownloadModal('${img.id}')">Download</button>
                    `;
                    document.getElementById('imageContainer').appendChild(card);
                });
            } catch (error) {
                console.log('error loading images:', error);
            }
        }

        // handle image preview
        function showLightbox(imgUrl, photoData) {
            currentPhotoData = photoData;
            document.getElementById('expandedImg').src = imgUrl;
            document.getElementById('lightbox').style.display = 'block';
            
            // build attribution
            const attribution = `Photo by <a href="${photoData.user.links.html}?utm_source=dark_ux&utm_medium=referral">${photoData.user.name}</a> 
                               on <a href="${photoData.links.html}?utm_source=dark_ux&utm_medium=referral">Unsplash</a>`;
            document.getElementById('imageAttribution').innerHTML = attribution;
        }

        function closeLightbox() {
            document.getElementById('lightbox').style.display = 'none';
        }

        // handle downloads
        function showDownloadModal(photoId) {
            document.getElementById('downloadModal').style.display = 'block';
        }

        function handlePremiumDownload() {
            document.getElementById('downloadModal').style.display = 'none';
            document.getElementById('premiumModal').style.display = 'block';
        }

        async function handleFreeDownload() {
            // dark pattern: hidden newsletter signup
            if(document.getElementById('newsletter').checked) {
                console.log('user added to newsletter without consent');
            }
            
            // actual download
            const link = document.createElement('a');
            link.href = currentPhotoData.urls.raw + '&dl=';
            link.download = 'unsplash-image.jpg';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            document.getElementById('downloadModal').style.display = 'none';
        }

        // search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            loadImages(e.target.value);
        });

        // initialize
        loadImages();
    </script>
</body>
</html>